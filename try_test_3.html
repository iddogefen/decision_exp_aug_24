<!DOCTYPE html>
<html>
  <head>

    <style>
        .hide_cursor {
            cursor: none;
        }
        </style>

    <title>My experiment</title>
    <script src="jspsych/plugins/jspsych.js"></script>
    <!--<script src="jspsych/plugins/jspsych-order.js"></script>-->
    <script src="jspsych/plugins/plugin-instructions.js"></script>
    <script src="jspsych/plugins/plugin-survey-text.js"></script>
    <script src="jspsych/plugins/plugin-html-keyboard-response.js"></script>
    <script src="jspsych/plugins/plugin-image-button-response.js"></script>
    <script src="jspsych/plugins/plugin-image-keyboard-response.js"></script>
    <script src="jspsych/plugins/plugin-html-audio-response.js"></script>
    <script src="jspsych/plugins/plugin-initialize-microphone.js"></script>
    <script src="jspsych/plugins/plugin-fullscreen.js"></script>
    <script src="jspsych/plugins/plugin-preload.js"></script>
    <script src="jspsych/plugins/plugin-browser-check.js"></script>

    <script src="Tools/Functions.js"></script>


    <link rel="stylesheet" href="jspsych/css/jspsych.css">
  </head>
  <body></body>
  <script>

//var data_folder             = 'data/Individual_data/'
var data_folder             = 'data/'

var int_data_folder         = 'data/Interactive_data/'
var tools_folder            = 'Tools'

    /* initialize jsPsych */
    var jsPsych = initJsPsych({
      on_finish: function() {
        saveData(data_folder+'All_data/all_data_sub_'+subject_id+".csv", jsPsych.data.get().csv());
        //jsPsych.data.get().localSave('csv','mydata.csv');

      }
    });

    /* create timeline */
var timeline = [];

    // generate a random subject ID with 15 characters
var subject_id = jsPsych.randomization.randomID(15);
var subject_url = jsPsych.data.urlVariables();


// pick a random condition for the subject at the start of the experiment
//var condition_assignment = jsPsych.randomization.sampleWithoutReplacement(['conditionA', 'conditionB', 'conditionC'], 1)[0];


function getRandomCondition() {
    const conditions = ['linear', 'nonlinear', 'noOrder'];
    const randomIndex = Math.floor(Math.random() * conditions.length);
    return conditions[randomIndex];
}

function chooseRandomItems(list, condition, count) {
    const items = list[condition];
    if (condition === 'linear') {
        // If the condition is 'linear', keep the original order
        return items.slice(0, count).map(item => ({ condition, path: item }));
    } else {
        // If the condition is not 'linear', shuffle the items
        const shuffledItems = items.sort(() => Math.random() - 0.5).slice(0, count);
        return shuffledItems.map(item => ({ condition, path: item }));
    }
}
var list0 = [
    'images/instructions/movie_1.png',
    'images/instructions/movie_2.png',
    'images/instructions/movie_3.png',
    'images/instructions/movie_4.png',
];

var audio_id = [];

  // capture info 
  var subject_id = jsPsych.data.getURLVariable('participantId');
  var study_id = jsPsych.data.getURLVariable('assignmentId');
  var session_id = jsPsych.data.getURLVariable('projectId');
  var urlvar = jsPsych.data.urlVariables();
  const currentUrl = window.location.href;



  jsPsych.data.addProperties({
    subject_id: subject_id,
    study_id: study_id,
    session_id: session_id,
    urlvar: urlvar,
    current_url: currentUrl
  });


// this adds a property called 'subject' and a property called 'condition' to every trial
jsPsych.data.addProperties({
  subject: subject_id,
  //condition: condition_assignment
});


    /* preload images */
    var preload = {
      type: jsPsychPreload,
      images:['images/instructions/movie_1.png',
 'images/instructions/movie_2.png',
 'images/instructions/movie_3.png',
 'images/instructions/movie_4.png',
]
};
    timeline.push(preload);

    var trial_01 = {
  type: jsPsychFullscreen,
  fullscreen_mode: true
}

  /* create timeline */
timeline.push(trial_01);


    var trial_02 = {
        type: jsPsychInitializeMicrophone
    };
    timeline.push(trial_02);


    var trial_03 = {
        type: jsPsychInstructions,
        pages: [

        '<span style="color: black; font-size: 24px"> Welcome to the experiment. Click next to begin.</span>',
    '<span style="color: black; font-size: 24px"> In this experiment, you will see a list of images that people do on a daily basis.  </span>' +'<br/>'+ '<span style="color: black; font-size: 24px">  </span>'
    +'<br/>'+ '<span style="color: black; font-size: 24px"> After the picture is displayed, you will be asked to answer a question related to that image presented. </span>'
    +'<br/>'+ '<span style="color: black; font-size: 24px"> Click "Next" for an example. </span>',
    
    ],
    show_clickable_nav: true
    };
    timeline.push(trial_03);


    var trial_04 = {
    timeline: [

    {
    type: jsPsychImageButtonResponse,
    stimulus: jsPsych.timelineVariable('face'),
    stimulus_width:"300",
    stimulus_height:'300' ,
    choices: [],
    prompt: "",
    trial_duration: "4500"

    },
    {
    type: jsPsychImageButtonResponse,
    prompt: '<p></p>',
    stimulus: jsPsych.timelineVariable('face'),
    stimulus_width:"300",
    stimulus_height:'300',
    trial_duration: "2700",
    choices: ['yes', 'no',],
    prompt: "<p>Is there a person in the picture?</p>",  },
  {
    type: jsPsychImageButtonResponse,
    stimulus: [],
    choices: [],
    prompt: "",
    trial_duration: "1800"
  }
],
timeline_variables: [
        {face: 'images/instructions/movie_1.png'},
        {face: 'images/instructions/movie_2.png'},
        {face: 'images/instructions/movie_3.png'},
        {face: 'images/instructions/movie_4.png'},
        


    ],

}
    timeline.push(trial_04);


var trial_15 = {
  type: jsPsychSurveyText,
  questions: [
    {prompt: 'please insert your gender (MALE/ FEMALE/ OTHER)'},
    {prompt: 'Please insert your age'},
    {prompt: 'Please insert your Connect ID'}

  ]
}
timeline.push(trial_15);


var trial_16 = {
        type: jsPsychInstructions,
        pages: [

        '<span style="color: black; font-size: 24px"> You have completed the experiment.'  +'<br/>'+ 'The completion code is : AJFHBG892' +'<br/>'+  'Thank you for your participation!</span> '

    ],
    show_clickable_nav: true
    };
    timeline.push(trial_16);

    /* start the experiment */
    var trial_17 = {
  type: jsPsychSurveyText,
  questions: [
    {prompt: 'please insert The completion code'},]
}
timeline.push(trial_17);

jsPsych.run(timeline);




  </script>
</html>
